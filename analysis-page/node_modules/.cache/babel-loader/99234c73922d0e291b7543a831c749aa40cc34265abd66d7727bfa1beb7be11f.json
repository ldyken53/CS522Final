{"ast":null,"code":"var _jsxFileName = \"/Users/kokofan/Documents/project/CS522_analysis/src/pieChart.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useMemo } from 'react';\nimport useSVGCanvas from './useSVGCanvas.js';\nimport * as d3 from 'd3';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function PlotPieChart(props) {\n  _s();\n  // //this is a generic component for plotting a d3 plot\n  const d3Container = useRef(null);\n  const [svg, height, width, tTip] = useSVGCanvas(d3Container);\n  // console.log(svg, height, width, tTip);\n\n  const chartSelection = useMemo(() => {\n    if (svg === undefined | props.data === undefined) {\n      return;\n    }\n    var categories = ['Adult', 'Violence', 'Hate_Speech', 'Discrimination', 'Online_Predators'];\n    var cag_counts = new Array(categories.length).fill(0);\n    for (let d of props.data) {\n      var index = categories.indexOf(d.category);\n      cag_counts[index] += 1;\n    }\n    var pieData = [];\n    var tCount = 0;\n    for (let i = 0; i < categories.length; i++) {\n      let entry = {\n        'category': categories[i],\n        'count': cag_counts[i]\n      };\n      tCount += cag_counts[i];\n      pieData.push(entry);\n    }\n\n    // console.log(pieData);\n\n    const radius = width * 0.2;\n    var ordScale = d3.scaleOrdinal().domain(pieData).range(['#ffd384', '#94ebcd', '#fbaccc', '#d3e0ea', '#fa7f72']);\n    let pieChart = svg.append(\"g\").attr('class', 'stack').attr(\"transform\", \"translate(\" + (width / 3 + radius) + \", \" + (radius + 20) + \")\");\n    var pie = d3.pie().value(function (d) {\n      return d.count;\n    });\n    var arc = pieChart.selectAll(\"arc\").data(pie(pieData)).enter();\n    var path = d3.arc().outerRadius(radius).innerRadius(0);\n    arc.append(\"path\").attr(\"d\", path).attr(\"fill\", function (d) {\n      return ordScale(d.data.category);\n    });\n    var label = d3.arc().outerRadius(radius).innerRadius(0);\n    var label2 = d3.arc().outerRadius(radius * 2.1).innerRadius(0);\n    arc.append(\"text\").attr(\"transform\", function (d) {\n      // console.log(d);\n      var rotation = (d.startAngle / 2 + d.endAngle / 2) * 180 / Math.PI;\n      return \"translate(\" + label2.centroid(d) + \") rotate(\" + rotation + \")\";\n    }).text(function (d) {\n      return d.data.category;\n    }).style(\"font-family\", \"arial\").style(\"font-size\", 12).style(\"text-anchor\", \"middle\");\n    arc.append(\"text\").attr(\"transform\", function (d) {\n      var rotation = (d.startAngle / 2 + d.endAngle / 2) * 180 / Math.PI;\n      return \"translate(\" + label.centroid(d) + \") rotate(\" + rotation + \")\";\n    }).text(function (d) {\n      return (d.data.count / tCount * 100).toFixed(0) + '%';\n    }).style(\"font-family\", \"arial\").style(\"font-size\", 12).style(\"text-anchor\", \"left\");\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"d3-component\",\n    style: {\n      'height': '99%',\n      'width': '99%'\n    },\n    ref: d3Container\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 9\n  }, this);\n}\n_s(PlotPieChart, \"ZIF2Y6G+4lDrENfXS4yyPmH62/0=\", false, function () {\n  return [useSVGCanvas];\n});\n_c = PlotPieChart;\nvar _c;\n$RefreshReg$(_c, \"PlotPieChart\");","map":{"version":3,"names":["React","useEffect","useRef","useMemo","useSVGCanvas","d3","jsxDEV","_jsxDEV","PlotPieChart","props","_s","d3Container","svg","height","width","tTip","chartSelection","undefined","data","categories","cag_counts","Array","length","fill","d","index","indexOf","category","pieData","tCount","i","entry","push","radius","ordScale","scaleOrdinal","domain","range","pieChart","append","attr","pie","value","count","arc","selectAll","enter","path","outerRadius","innerRadius","label","label2","rotation","startAngle","endAngle","Math","PI","centroid","text","style","toFixed","className","ref","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/kokofan/Documents/project/CS522_analysis/src/pieChart.js"],"sourcesContent":["import React, {useEffect, useRef, useMemo} from 'react';\nimport useSVGCanvas from './useSVGCanvas.js';\nimport * as d3 from 'd3';\n\n\nexport default function PlotPieChart(props){\n    // //this is a generic component for plotting a d3 plot\n    const d3Container = useRef(null);\n    const [svg, height, width, tTip] = useSVGCanvas(d3Container);\n    // console.log(svg, height, width, tTip);\n\n    const chartSelection = useMemo(()=>{\n        if(svg === undefined | props.data === undefined){ return }\n\n        var categories = ['Adult', 'Violence', 'Hate_Speech', 'Discrimination', 'Online_Predators'];\n\n        var cag_counts = new Array(categories.length).fill(0);\n        for(let d of props.data){\n            var index = categories.indexOf(d.category);\n            cag_counts[index] += 1;\n        }\n\n        var pieData = [];\n        var tCount = 0;\n        for (let i =0; i < categories.length; i++) {\n            let entry = {\n                'category': categories[i],\n                'count': cag_counts[i],\n            }\n            tCount += cag_counts[i];\n            pieData.push(entry);\n        }\n\n        // console.log(pieData);\n\n        const radius = width*0.2;\n\n        var ordScale = d3.scaleOrdinal()\n                        .domain(pieData)\n                        .range(['#ffd384','#94ebcd','#fbaccc','#d3e0ea','#fa7f72']);\n\n        let pieChart = svg.append(\"g\")\n                            .attr('class','stack')\n                            .attr(\"transform\", \"translate(\" + (width/3 + radius) + \", \" + (radius + 20)  + \")\");\n\n        var pie = d3.pie().value(function(d) { \n                return d.count; \n            });\n\n        var arc = pieChart.selectAll(\"arc\")\n                   .data(pie(pieData))\n                   .enter();\n\n        var path = d3.arc()\n                     .outerRadius(radius)\n                     .innerRadius(0);\n\n        arc.append(\"path\")\n           .attr(\"d\", path)\n           .attr(\"fill\", function(d) { return ordScale(d.data.category); });\n\n        var label = d3.arc()\n                      .outerRadius(radius)\n                      .innerRadius(0);\n\n        var label2 = d3.arc()\n                      .outerRadius(radius*2.1)\n                      .innerRadius(0);\n            \n        arc.append(\"text\")\n           .attr(\"transform\", function(d) { \n                // console.log(d);\n                var rotation = (d.startAngle/2 + d.endAngle/2) * 180/Math.PI;\n                return \"translate(\" + (label2.centroid(d)) + \") rotate(\" + rotation + \")\"; \n            })\n           .text(function(d) { return d.data.category; })\n           .style(\"font-family\", \"arial\")\n           .style(\"font-size\", 12)\n           .style(\"text-anchor\", \"middle\");\n\n        arc.append(\"text\")\n           .attr(\"transform\", function(d) { \n                var rotation = (d.startAngle/2 + d.endAngle/2) * 180/Math.PI;\n                return \"translate(\" + (label.centroid(d)) + \") rotate(\" + rotation + \")\"; \n            })\n           .text(function(d) { return (d.data.count/tCount * 100).toFixed(0) + '%'; })\n           .style(\"font-family\", \"arial\")\n           .style(\"font-size\", 12)\n           .style(\"text-anchor\", \"left\");\n\n    });\n\n    return (\n        <div\n            className={\"d3-component\"}\n            style={{'height':'99%','width':'99%'}}\n            ref={d3Container}\n        ></div>\n    );\n}\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}