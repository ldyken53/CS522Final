{"ast":null,"code":"var _jsxFileName = \"/Users/kokofan/Documents/project/CS522_analysis/src/feedChart.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useMemo } from 'react';\nimport useSVGCanvas from './useSVGCanvas.js';\nimport * as d3 from 'd3';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function PlotBarChart(props) {\n  _s();\n  // //this is a generic component for plotting a d3 plot\n  const d3Container = useRef(null);\n  const [svg, height, width, tTip] = useSVGCanvas(d3Container);\n  // console.log(svg, height, width, tTip);\n\n  const chartSelection = useMemo(() => {\n    if (svg === undefined | props.data === undefined) {\n      return;\n    }\n    const feedbacks = ['Agree', 'Disagree'];\n    const padding = 40;\n    const dates = props.data.map(d => d.date);\n    const counts = {};\n    for (const d of dates) {\n      counts[d] = counts[d] ? counts[d] + 1 : 1;\n    }\n    const allDates = Object.keys(counts);\n    const data = [];\n    for (var k in allDates) {\n      for (var c in feedbacks) {\n        var res = props.data.filter(function (d) {\n          return d.date == allDates[k] && d.feedback == feedbacks[c];\n        });\n        let entry = {\n          'date': allDates[k],\n          'feedback': feedbacks[c],\n          'count': res.length\n        };\n        data.push(entry);\n      }\n    }\n    const sumstat = d3.group(data, d => d.feedback);\n\n    // console.log(sumstat);\n\n    const dateLen = Object.keys(counts).length;\n    var x = d3.scaleBand().domain(allDates).range([0, width - padding * 3]);\n    svg.append(\"g\").attr(\"transform\", \"translate(\" + padding + ',' + (height - 1.5 * padding) + \") \").call(d3.axisBottom(x).ticks(dateLen)).selectAll(\"text\").attr(\"transform\", \"translate(-10,20)rotate(-45)\").style(\"text-anchor\", \"middle\").style(\"font-size\", 10);\n    var y = d3.scaleLinear().domain([0, d3.max(data, function (d) {\n      return +d.count;\n    })]).range([height - padding * 2.5, 0]);\n    svg.append(\"g\").attr(\"transform\", \"translate(\" + padding + ',' + 1 * padding + \")\").call(d3.axisLeft(y));\n    const color = d3.scaleOrdinal().range(['#e41a1c', '#ff7f00']);\n\n    // Draw the line\n    svg.selectAll(\".line\").data(sumstat).join(\"path\").attr(\"fill\", \"none\").attr(\"stroke\", function (d) {\n      return color(d[0]);\n    }).attr(\"stroke-width\", 1.5).attr(\"d\", function (d) {\n      return d3.line().x(function (d) {\n        return x(d.date);\n      }).y(function (d) {\n        return y(+d.count);\n      })(d[1]);\n    }).attr(\"transform\", \"translate(\" + padding + ',' + 0.5 * padding + \")\");\n    var legend = svg.append('g').attr('class', 'legend').attr('transform', 'translate(' + (width - padding * 2) + \", \" + padding + ')');\n    var legend_colors = ['#e41a1c', '#377eb8', '#4daf4a', '#ff7f00'];\n    // draw legends\n    legend.selectAll('rect').data(feedbacks).enter().append('rect').attr('x', 0).attr('y', function (d, i) {\n      return i * 18;\n    }).attr('width', 12).attr('height', 12).attr('fill', function (d, i) {\n      return legend_colors[i];\n    });\n    legend.selectAll('text').data(feedbacks).enter().append('text').text(function (d) {\n      return d;\n    }).attr('x', 19).attr('y', function (d, i) {\n      return i * 19;\n    }).attr('text-anchor', 'start').attr('alignment-baseline', 'hanging').style(\"font-size\", 7);\n    svg.append(\"text\").attr(\"class\", \"x-label\").attr(\"x\", width - padding).attr(\"y\", height - padding).attr(\"text-anchor\", \"middle\").text(\"Date\");\n\n    // lable of y axis\n    svg.append(\"text\").attr(\"class\", \"y-label\").attr(\"text-anchor\", \"middle\").attr(\"x\", -height / 2).attr(\"y\", padding / 4).attr(\"dy\", \".75em\").attr(\"transform\", \"rotate(-90)\").text(\"Access Count\");\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"d3-component\",\n    style: {\n      'height': '99%',\n      'width': '99%'\n    },\n    ref: d3Container\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 139,\n    columnNumber: 9\n  }, this);\n}\n_s(PlotBarChart, \"ZIF2Y6G+4lDrENfXS4yyPmH62/0=\", false, function () {\n  return [useSVGCanvas];\n});\n_c = PlotBarChart;\nvar _c;\n$RefreshReg$(_c, \"PlotBarChart\");","map":{"version":3,"names":["React","useEffect","useRef","useMemo","useSVGCanvas","d3","jsxDEV","_jsxDEV","PlotBarChart","props","_s","d3Container","svg","height","width","tTip","chartSelection","undefined","data","feedbacks","padding","dates","map","d","date","counts","allDates","Object","keys","k","c","res","filter","feedback","entry","length","push","sumstat","group","dateLen","x","scaleBand","domain","range","append","attr","call","axisBottom","ticks","selectAll","style","y","scaleLinear","max","count","axisLeft","color","scaleOrdinal","join","line","legend","legend_colors","enter","i","text","className","ref","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/kokofan/Documents/project/CS522_analysis/src/feedChart.js"],"sourcesContent":["import React, {useEffect, useRef, useMemo} from 'react';\nimport useSVGCanvas from './useSVGCanvas.js';\nimport * as d3 from 'd3';\n\n\nexport default function PlotBarChart(props){\n    // //this is a generic component for plotting a d3 plot\n    const d3Container = useRef(null);\n    const [svg, height, width, tTip] = useSVGCanvas(d3Container);\n    // console.log(svg, height, width, tTip);\n\n    const chartSelection = useMemo(()=>{\n        if(svg === undefined | props.data === undefined){ return }\n\n        const feedbacks = ['Agree', 'Disagree'];\n        const padding = 40;\n\n        const dates =  props.data.map(d => d.date);\n\n        const counts = {};\n        for (const d of dates) {\n          counts[d] = counts[d] ? counts[d] + 1 : 1;\n        }\n\n        const allDates = Object.keys(counts);\n\n        const data = [] \n        for (var k in allDates){\n            for (var c in feedbacks){\n                var res = props.data.filter(function (d) {\n                    return d.date == allDates[k] &&\n                    d.feedback == feedbacks[c];\n                });\n\n                let entry = {\n                    'date': allDates[k],\n                    'feedback': feedbacks[c],\n                    'count': res.length,\n                }\n\n                data.push(entry);\n            }\n        }\n\n        const sumstat = d3.group(data, d => d.feedback); \n\n        // console.log(sumstat);\n\n        const dateLen = Object.keys(counts).length;\n\n        var x = d3.scaleBand()\n            .domain(allDates)       \n            .range([0, width - padding*3]); \n\n        svg.append(\"g\")\n                .attr(\"transform\", \"translate(\" + padding + ',' + (height-1.5*padding) + \") \")\n                .call(d3.axisBottom(x).ticks(dateLen))\n                .selectAll(\"text\")\n                .attr(\"transform\", \"translate(-10,20)rotate(-45)\")\n                .style(\"text-anchor\", \"middle\")\n                .style(\"font-size\", 10);\n\n        var y = d3.scaleLinear()\n                  .domain([0, d3.max(data, function(d) { return +d.count; })])\n                  .range([ height - padding*2.5, 0 ]);\n  \n        svg.append(\"g\")\n            .attr(\"transform\", \"translate(\" + padding + ',' + 1*padding + \")\")\n            .call(d3.axisLeft(y));\n\n        const color = d3.scaleOrdinal()\n            .range(['#e41a1c','#ff7f00'])\n\n\n          // Draw the line\n          svg.selectAll(\".line\")\n              .data(sumstat)\n              .join(\"path\")\n                .attr(\"fill\", \"none\")\n                .attr(\"stroke\", function(d){ return color(d[0]) })\n                .attr(\"stroke-width\", 1.5)\n                .attr(\"d\", function(d){\n                  return d3.line()\n                    .x(function(d) { return x(d.date); })\n                    .y(function(d) { return y(+d.count); })\n                    (d[1])\n                })\n                .attr(\"transform\", \"translate(\" + padding + ',' + 0.5*padding + \")\");\n\n\n        var legend = svg.append('g')\n            .attr('class', 'legend')\n            .attr('transform', 'translate(' + (width - padding*2) + \", \" + padding + ')' );\n\n        var legend_colors = ['#e41a1c', '#377eb8', '#4daf4a', '#ff7f00'];\n        // draw legends\n        legend.selectAll('rect')\n              .data(feedbacks)\n              .enter()\n              .append('rect')\n              .attr('x', 0)\n              .attr('y', function(d, i){ return i * 18; })\n              .attr('width', 12)\n              .attr('height', 12)\n              .attr('fill', function(d, i){\n                  return legend_colors[i];\n              });\n\n        legend.selectAll('text')\n              .data(feedbacks)\n              .enter()\n              .append('text')\n              .text(function(d){ return d; })\n              .attr('x', 19)\n              .attr('y', function(d, i){ return i * 19;})\n              .attr('text-anchor', 'start')\n              .attr('alignment-baseline', 'hanging')\n              .style(\"font-size\", 7);\n\n        svg.append(\"text\")\n           .attr(\"class\", \"x-label\")\n           .attr(\"x\", width - padding)\n           .attr(\"y\", height - padding)\n           .attr(\"text-anchor\", \"middle\")\n           .text(\"Date\")\n\n        // lable of y axis\n        svg.append(\"text\")\n           .attr(\"class\", \"y-label\")\n           .attr(\"text-anchor\", \"middle\")\n           .attr(\"x\", -height/2)\n           .attr(\"y\", padding/4)\n           .attr(\"dy\", \".75em\")\n           .attr(\"transform\", \"rotate(-90)\")\n           .text(\"Access Count\");\n    });\n\n    return (\n        <div\n            className={\"d3-component\"}\n            style={{'height':'99%','width':'99%'}}\n            ref={d3Container}\n        ></div>\n    );\n}\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}